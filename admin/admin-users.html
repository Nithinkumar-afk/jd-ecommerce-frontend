<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin ‚Äì Users | JD</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#000;
  --card:rgba(255,255,255,.08);
  --border:rgba(255,255,255,.15);
  --text:#e5e7eb;
  --muted:#94a3b8;
}

*{ box-sizing:border-box; margin:0; padding:0 }

body{
  font-family:Poppins,sans-serif;
  background:var(--bg);
  color:var(--text);
}

/* HEADER */
header{
  padding:18px 22px;
  background:var(--card);
  border-bottom:1px solid var(--border);
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:14px;
}

header h2{
  font-size:18px;
  font-weight:600;
}

header a{
  color:#fff;
  text-decoration:none;
  font-size:14px;
  opacity:.9;
}

/* NAV */
.nav{
  display:flex;
  gap:12px;
  padding:16px 22px;
  flex-wrap:wrap;
}

.nav a{
  text-decoration:none;
  color:#fff;
  padding:12px 18px;
  border-radius:16px;
  background:var(--card);
  border:1px solid var(--border);
  font-size:14px;
}

/* SECTION */
.section{
  padding:24px 22px;
  max-width:1200px;
  margin:auto;
}

.section h3{
  margin-bottom:16px;
  font-size:16px;
  font-weight:600;
}

/* USER CARD */
.user-card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:20px;
  padding:18px;
  margin-bottom:16px;
  display:flex;
  gap:18px;
  align-items:center;
}

.user-img{
  width:80px;
  height:80px;
  border-radius:50%;
  background:#020617;
  overflow:hidden;
  flex-shrink:0;
  border:1px solid var(--border);
}

.user-img img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.user-info p{
  margin-bottom:6px;
  font-size:14px;
  color:var(--muted);
}

.user-info strong{
  color:#fff;
}

/* MOBILE */
@media(max-width:600px){
  header{ flex-direction:column; align-items:flex-start }
  header h2{ font-size:16px }

  .nav a{ flex:1; text-align:center }

  .section{ padding:16px 14px }

  .user-card{
    flex-direction:column;
    align-items:flex-start;
    gap:14px;
  }

  .user-img{ width:70px; height:70px }
  .user-info p{ font-size:13px }
}
</style>
</head>

<body>

<header>
  <h2>JD Admin ‚Äì Users</h2>
  <a href="admin-dashboard.html">‚Üê Dashboard</a>
</header>

<div class="nav">
  <a href="admin-products.html">üì¶ Products</a>
  <a href="admin-orders.html">üìë Orders</a>
  <a href="admin-users.html">üë• Users</a>
</div>

<div class="section">
  <h3>All Users</h3>
  <div id="usersList">Loading users...</div>
</div>

<script>
"use strict";

/* ================= AUTH ================= */
const ADMIN_KEY = localStorage.getItem("jd_admin");
if (!ADMIN_KEY) {
  alert("Unauthorized access");
  location.href = "../index.html";
}

/* ================= CONFIG ================= */
const API_BASE = window.APP_CONFIG.API_BASE; // ‚úÖ GLOBAL CONFIG
const FALLBACK_IMG = "https://via.placeholder.com/80?text=User";
const usersList = document.getElementById("usersList");

/* ================= LOAD USERS ================= */
async function loadUsers() {
  try {
    const res = await fetch(API_BASE + "/api/users", {
      headers: { "x-api-key": ADMIN_KEY }
    });

    if (!res.ok) throw new Error();

    const users = await res.json();
    usersList.innerHTML = "";

    if (!users.length) {
      usersList.innerHTML =
        "<p style='opacity:.6'>No users available</p>";
      return;
    }

    users.forEach(u => {
      const joined =
        u.created_at
          ? new Date(u.created_at).toLocaleDateString()
          : "‚Äî";

      usersList.innerHTML += `
        <div class="user-card">
          <div class="user-img">
            <img src="${u.image ? API_BASE + u.image : FALLBACK_IMG}"
                 onerror="this.src='${FALLBACK_IMG}'">
          </div>
          <div class="user-info">
            <p><strong>${u.name || "Guest User"}</strong></p>
            <p>üìû Phone: ${u.phone || "-"}</p>
            <p>üè† Address: ${u.address || "-"}</p>
            <p style="font-size:12px;opacity:.6">
              Joined: ${joined}
            </p>
          </div>
        </div>
      `;
    });

  } catch {
    usersList.innerHTML =
      "<p style='color:#ff6b6b'>Failed to load users</p>";
  }
}

/* ================= INIT ================= */
loadUsers();
</script>

</body>
</html>
